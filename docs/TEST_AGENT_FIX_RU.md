# –¢–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã —Å –º–æ—Ä–≥–∞–Ω–∏–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã –º–µ–Ω—é

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

–ü—Ä–æ–±–ª–µ–º–∞ —Å –º–æ—Ä–≥–∞–Ω–∏–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞–∂–¥—ã–µ ~10 —Å–µ–∫—É–Ω–¥ –ø—Ä–∏ –≤–≤–æ–¥–µ —Ç–µ–∫—Å—Ç–∞ –≤ AI-–∞–≥–µ–Ω—Ç–∞ –±—ã–ª–∞ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞.

### –ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã
- **Watchdog** –≤ `AutoRefresh.tsx` –ø—Ä–æ–≤–µ—Ä—è–ª "–∑–∞–≤–∏—Å–∞–Ω–∏—è" –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
- –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∞–≥–µ–Ω—Ç–æ–º (–≤–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞, –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤) –≥–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫ –º–æ–≥ —Ç–æ—Ä–º–æ–∑–∏—Ç—å—Å—è
- Watchdog –¥—É–º–∞–ª, —á—Ç–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≤–∏—Å–ª–∞, –∏ –ø—ã—Ç–∞–ª—Å—è –µ—ë –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å
- –ó–∞—â–∏—Ç–∞ –æ—Ç —á–∞—Å—Ç—ã—Ö –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–æ–∫ –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∞ —ç—Ç–æ, –Ω–æ –≤—ã–∑—ã–≤–∞–ª–∞ "–º–æ—Ä–≥–∞–Ω–∏–µ"

### –†–µ—à–µ–Ω–∏–µ
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∞–≥–µ–Ω—Ç–∞ ‚Äî watchdog –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –∫–æ–≥–¥–∞ –≤—ã –ø–µ—á–∞—Ç–∞–µ—Ç–µ  
‚úÖ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –Ω–∞ 30 —Å–µ–∫—É–Ω–¥, –µ—Å–ª–∏ –∞–≥–µ–Ω—Ç –∞–∫—Ç–∏–≤–µ–Ω  
‚úÖ –£–ª—É—á—à–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π  

## –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ dev-—Å–µ—Ä–≤–µ—Ä
```bash
npm run dev
```

### 2. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –º–µ–Ω—é
```
http://localhost:3000/ru/menu
```

### 3. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12 ‚Üí Console)

### 4. –¢–µ—Å—Ç 1: –†–∞–±–æ—Ç–∞ —Å –∞–≥–µ–Ω—Ç–æ–º
1. **–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –∞–≥–µ–Ω—Ç–∞** –≤–Ω–∏–∑—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
2. **–ù–∞—á–Ω–∏—Ç–µ –ø–µ—á–∞—Ç–∞—Ç—å** –≤–æ–ø—Ä–æ—Å –∞–≥–µ–Ω—Ç—É
3. **–ü–æ–¥–æ–∂–¥–∏—Ç–µ 10-15 —Å–µ–∫—É–Ω–¥**, –ø—Ä–æ–¥–æ–ª–∂–∞—è –ø–µ—á–∞—Ç–∞—Ç—å –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç
4. ‚úÖ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ù–ï –¥–æ–ª–∂–Ω–∞ –º–æ—Ä–≥–∞—Ç—å/–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è
5. –í –∫–æ–Ω—Å–æ–ª–∏ –≤—ã –ù–ï –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è:
   - `‚ö†Ô∏è Watchdog: main thread stall detected`
   - `üîÑ RELOAD EXECUTING`

### 5. –¢–µ—Å—Ç 2: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
1. **–ù–∞–ø–∏—à–∏—Ç–µ –≤–æ–ø—Ä–æ—Å** (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–ü–æ—Å–æ–≤–µ—Ç—É–π —Å–∞—Ç–∏–≤—É")
2. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ** (–Ω–∞–∂–º–∏—Ç–µ Enter –∏–ª–∏ –∫–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏)
3. **–ü–æ–¥–æ–∂–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç–∞ –∞–≥–µ–Ω—Ç–∞**
4. ‚úÖ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ù–ï –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
   - –ê–≥–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ
   - –ù–µ—Ç –º–æ—Ä–≥–∞–Ω–∏—è —ç–∫—Ä–∞–Ω–∞

### 6. –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—â–∏—Ç—ã –æ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏–π
1. **–ó–∞–∫—Ä–æ–π—Ç–µ –∞–≥–µ–Ω—Ç–∞** (–Ω–µ —Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞)
2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
   ```javascript
   // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≤–∏—Å–∞–Ω–∏—è (–≤—ã–ø–æ–ª–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∞!)
   let start = Date.now();
   while (Date.now() - start < 35000) { /* –±–ª–æ–∫–∏—Ä—É–µ–º –ø–æ—Ç–æ–∫ */ }
   ```
3. ‚úÖ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 
   - –ß–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è `‚ö†Ô∏è Watchdog: main thread stall detected`
   - –ü–æ—Å–ª–µ 3-—Ö –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è
   - –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ ‚Äî watchdog –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∞–Ω–∏–π

**‚ö†Ô∏è –ù–ï –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –¢–µ—Å—Ç 3 –∫–æ–≥–¥–∞ –∞–≥–µ–Ω—Ç –∞–∫—Ç–∏–≤–µ–Ω!**

### 7. –¢–µ—Å—Ç 4: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–í –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
üêï Watchdog: TV=false, slow=false, disabled=false, timeout=30000ms, check=10000ms, maxStalls=3
üêï Device info: UA=Mozilla/5.0..., screen=1920x1080, cores=8
üîÑ Auto-refresh scheduled for: 14:35:20
```

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∞–≥–µ–Ω—Ç–æ–º (–µ—Å–ª–∏ watchdog —á—Ç–æ-—Ç–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç, –Ω–æ –Ω–µ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—Ç—å):
```
üö´ RELOAD DELAYED: Agent is active, postponing reload from ...
```

## –ß—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏

### ‚úÖ –•–æ—Ä–æ—à–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞):
- `‚úÖ Watchdog: lag recovered, resetting stall counter` ‚Äî –≤—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ
- `üö´ RELOAD DELAYED: Agent is active` ‚Äî –∑–∞—â–∏—Ç–∞ —Å—Ä–∞–±–æ—Ç–∞–ª–∞
- `‚è∞ Next auto-refresh in: 14m 35s` ‚Äî –ø–ª–∞–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç

### ‚ö†Ô∏è –ü–ª–æ—Ö–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω—É–∂–Ω–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å):
- `‚ö†Ô∏è Watchdog: main thread stall detected` **–≤–æ –≤—Ä–µ–º—è –ø–µ—á–∞—Ç–∏** ‚Äî –±–∞–≥
- `üîÑ RELOAD EXECUTING` **–≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å –∞–≥–µ–Ω—Ç–æ–º** ‚Äî –±–∞–≥

### üîÑ –ù–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ (–Ω–µ –±–∞–≥):
- `üîÑ RELOAD SOURCE: Supabase realtime - menu_items changed` ‚Äî –∞–¥–º–∏–Ω –∏–∑–º–µ–Ω–∏–ª –º–µ–Ω—é
- `üîÑ RELOAD SOURCE: 15-minute auto-refresh timer` ‚Äî –ø–ª–∞–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

## –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ù–ï –∏—Å—á–µ–∑–ª–∞

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∑–∞–ø—É—Å—Ç–∏–ª–∏ –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é (`npm run dev`)
2. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ (Ctrl+Shift+Del ‚Üí –ö—ç—à)
3. –°–¥–µ–ª–∞–π—Ç–µ hard refresh (Ctrl+F5 / Cmd+Shift+R)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥—Ä—É–≥–∏—Ö –æ—à–∏–±–æ–∫
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—Å—ë –∏–∑ –∫–æ–Ω—Å–æ–ª–∏ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: `docs/AGENT_AUTO_REFRESH_FIX.md`
- **–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã**:
  - `src/components/AutoRefresh.tsx`
  - `src/components/OGLabAgent.tsx`
  - `src/app/api/agent/chat/route.ts`

## –î–∞—Ç–∞: 5 –æ–∫—Ç—è–±—Ä—è 2025
