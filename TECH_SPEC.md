# Architecture Decision Records (ADR)

## ADR-002: Admin panel for Menu pricing and Design theme

Status: Proposed

Date: 2025-09-19

Context

We need an authenticated admin UI to:
- edit Menu items/prices directly in a table-like interface
- optionally adjust design theme (brand colors) used by the site
- remain compatible with our current stack and deployment model

Current stack
- Next.js App Router (15.x), TypeScript, React Server/Client components
- Tailwind CSS for styling
- Data source for menu: Google Sheets via custom fetchers (`src/lib/google.ts`)
- Hosting: Next.js build (static prerender of pages with ISR), Nginx in front
- Auth: none in public site yet

Forces
- Keep content owners workflow simple (table editing)
- Minimize operational overhead; reuse Google Sheets as source of truth where possible
- Preserve static performance for public pages (ISR) while supporting timely updates
- Security: protect admin behind authentication and restrict access

Options considered
1) Build admin on top of Google Sheets only (no backend):
   - Pros: fastest; Sheets already store data
   - Cons: auth/sharing model of Sheets is separate; editing UI not branded; hard to constrain edits; no theme controls

2) Lightweight admin inside Next.js with Google Sheets read/write API
   - Pros: single app; keeps Sheets as source-of-truth; custom UI/validation; can add theme controls; compatible with ISR (trigger revalidate)
   - Cons: need service credentials with write scope; must secure admin routes

3) Migrate data to DB (e.g., SQLite/Postgres) and build full CRUD
   - Pros: strong control, migrations, versioning
   - Cons: more infra; diverges from current sheet-driven flow; time-to-value higher

Decision

UPDATE: We will use Supabase (Postgres + Auth) for admin authentication and as the primary data store for menu items. Google Sheets remains optional as an import/export source, but not the source of truth.

Rationale:
- Unified place for auth and data (roles, RLS, auditing) without standing up our own DB
- Stable writes/reads and simple revalidation flow for ISR
- Still can provide import/export with Sheets for convenience

High-level design
- Routes: `/admin` (protected)
- Auth: Supabase Auth. Users stored in Supabase; introduce custom role `menu-user` for admins of menu. Client uses Supabase JS with anon key; server uses service role for privileged operations.
- Permissions: role `admin` only (MVP)
- Data editing:
  - Table view –ø—Ä–∏–≤—è–∑–∞–Ω –∫ —Ç–∞–±–ª–∏—Ü–∞–º Supabase (—Å–º. —Å—Ö–µ–º–∞ –Ω–∏–∂–µ)
  - Server Actions —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `SUPABASE_SERVICE_ROLE_KEY` –≤—ã–ø–æ–ª–Ω—è—é—Ç –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏/—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
  - Optimistic UI, –¥–∏—Ñ—Ñ –ø—Ä–µ–≤—å—é, –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤/—Ü–µ–Ω
  - –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–ø–∏—Å–∏ ‚Äî on-demand revalidate –¥–ª—è `/menu`
- Theme editing:
  - Form for primary/secondary colors
  - Persist to `src/app/theme.json` equivalent (or `process.env` via env editor is out of scope). MVP: write a small JSON file in `/public/theme.json` and have `globals.css` read CSS variables at build or client-side fetch (client sets `:root` vars). For no rebuild: client-side inject CSS vars from fetched JSON and persist in file via server action.
- Security:
  - Admin pages are client components wrapped with session check (NextAuth)
  - API routes / server actions check session/role
  - Google service account key remains in env; server-only access

Impact on current site
- Public pages remain static/ISR. –ü–æ—Å–ª–µ –ø—Ä–∞–≤–æ–∫ –≤ Supabase –≤—ã–∑—ã–≤–∞–µ–º revalidate –¥–ª—è `/menu` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞ —Å–µ–∫—É–Ω–¥—ã.
- –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è Supabase –∫–∞–∫ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π Postgres —Å Auth; Sheets –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∫–∞–∫ –∏–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç.

Open questions
- Hosting constraints for writing to file (theme.json) in read-only containers: If FS is read-only, store theme in Google Sheets (separate tab) and load CSS vars from there.
- User management: for MVP keep a single admin account via env. Later add a small users sheet.

Plan (MVP)
1) –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Supabase Auth; –¥–æ—Å—Ç—É–ø –∫ `/admin` —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å —Ä–æ–ª—å—é `menu-user`.
2) Build `/admin/menu` page: fetch rows from Supabase, editable grid (per cell), validation, save via server action to Supabase, then revalidate.
3) Build `/admin/theme` page: preview + save primary/secondary; persist to theme sheet or JSON; apply on client via CSS vars.
4) Hardening: rate limit admin APIs, audit log basic (who changed what) appended to a sheet tab.

Logo upload (SVG)
- Storage: UploadThing
- Auth: server-side use of `UPLOADTHING_TOKEN` from environment; calls only from authenticated admin session
- UI: in `/admin/theme` –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ SVG; –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∞–ø–ª–æ–∞–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ–º URL –≤ theme‚Äëstorage (theme sheet/json)
- Validation: –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ç–æ–ª—å–∫–æ `image/svg+xml`, –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, ‚â§ 200KB), –ø—Ä–æ–≥–æ–Ω—è—Ç—å basic sanitization (strip script/foreignObject)
- Caching/CDN: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–π UploadThing CDN URL; –≤ –ø—É–±–ª–∏—á–Ω–æ–º UI –ø–æ–¥–º–µ–Ω—è—Ç—å `src` –ª–æ–≥–æ—Ç–∏–ø–∞ –Ω–∞ –Ω–æ–≤—ã–π URL; –¥–ª—è ISR —Å—Ç—Ä–∞–Ω–∏—Ü ‚Äî —Ä–µ–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å
- Rollback: —Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ URL –≤ audit (–ª–∏—Å—Ç) –¥–ª—è –æ—Ç–∫–∞—Ç–∞

Supabase integration
- Env vars:
  - `NEXT_PUBLIC_SUPABASE_URL`
  - `NEXT_PUBLIC_SUPABASE_ANON_KEY`
  - `SUPABASE_SERVICE_ROLE_KEY` (server-only)
- Auth & Roles:
  - –ò—Å–ø–æ–ª—å–∑—É–µ–º Supabase Auth; –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ –≤–≤–æ–¥–∏–º custom role `menu-user` (—á–µ—Ä–µ–∑ claims/metadata)
  - –î–æ—Å—Ç—É–ø –∫ admin routes –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (user has `menu-user`)
- Schema (–º–∏–Ω–∏–º—É–º):
  - `menu_items` (id, category, name, type, thc, cbg, price_1g, price_5g, price_20g, our, updated_at, updated_by)
  - `menu_layout` (id, column1 text[], column2 text[], column3 text[])
  - `theme` (id, primary, secondary, logo_url)
- RLS:
  - Public (anon) ‚Äî read-only select –Ω–∞ `menu_items`, `menu_layout`, `theme`
  - `menu-user` ‚Äî insert/update/delete –Ω–∞ —Ç–∞–±–ª–∏—Ü–∞—Ö –º–µ–Ω—é/—Ç–µ–º—ã
  - Service role ‚Äî –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö batch‚Äë–æ–ø–µ—Ä–∞—Ü–∏–π

Status tracking
- Target: land behind feature flag `ENABLE_ADMIN=true`.

# OG Lab Site - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Frontend
- **Next.js 15.5.3** - React —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —Å App Router
- **React 19.1.0** - UI –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
- **TypeScript 5** - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JavaScript
- **Tailwind CSS 3.4.17** - utility-first CSS —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **PostCSS 8.5.6** - CSS –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä

### Backend & Data
- **Google Sheets API** - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–µ–Ω—é
- **googleapis 159.0.0** - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Google API
- **ISR (Incremental Static Regeneration)** - –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç

### Deployment & Infrastructure
- **PM2** - –ø—Ä–æ—Ü–µ—Å—Å-–º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω
- **Nginx** - –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –∏ reverse proxy
- **Node.js** - —Å–µ—Ä–≤–µ—Ä–Ω–∞—è —Å—Ä–µ–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### Development Tools
- **ESLint 9** - –ª–∏–Ω—Ç–µ—Ä –∫–æ–¥–∞
- **Autoprefixer** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ CSS –ø—Ä–µ—Ñ–∏–∫—Å—ã

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
oglab-site/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/                    # Next.js App Router
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx           # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ menu/page.tsx      # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –º–µ–Ω—é
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx         # –ö–æ—Ä–Ω–µ–≤–æ–π layout
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ globals.css        # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ components/            # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AutoRefresh.tsx    # –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BreathingController.tsx # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∞–Ω–∏–º–∞—Ü–∏–∏ –¥—ã—Ö–∞–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MenuTime.tsx       # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ PacmanTrail.tsx    # –ê–Ω–∏–º–∞—Ü–∏—è –ø–∞–∫–º–∞–Ω–∞
‚îÇ   ‚îî‚îÄ‚îÄ lib/                   # –£—Ç–∏–ª–∏—Ç—ã –∏ —Ö–µ–ª–ø–µ—Ä—ã
‚îÇ       ‚îú‚îÄ‚îÄ google.ts          # Google Sheets API
‚îÇ       ‚îî‚îÄ‚îÄ menu-helpers.ts    # –•–µ–ª–ø–µ—Ä—ã –¥–ª—è –º–µ–Ω—é
‚îú‚îÄ‚îÄ public/                    # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ assets/images/         # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –∏–∫–æ–Ω–∫–∏
‚îú‚îÄ‚îÄ ecosystem.config.js        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PM2
‚îú‚îÄ‚îÄ nginx.conf                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx
‚îî‚îÄ‚îÄ package.json              # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
```

## üé® –î–∏–∑–∞–π–Ω —Å–∏—Å—Ç–µ–º–∞

### CSS –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **–û—Å–Ω–æ–≤–Ω–æ–π –ø–æ–¥—Ö–æ–¥**: Tailwind CSS utility-first
- **–ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç–∏–ª–∏**: `src/app/globals.css` –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ `:root` –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Å—Ç–∏–ª–µ–π**: CSS –∫–ª–∞—Å—Å—ã > inline —Å—Ç–∏–ª–∏ > CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

#### CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (`globals.css`)
```css
:root {
  --color-primary: #536C4A;        /* –û—Å–Ω–æ–≤–Ω–æ–π –∑–µ–ª–µ–Ω—ã–π */
  --color-primary-light: #B0BF93;  /* –°–≤–µ—Ç–ª—ã–π –∑–µ–ª–µ–Ω—ã–π */
}
```

#### –ö–∞—Å—Ç–æ–º–Ω—ã–µ CSS –∫–ª–∞—Å—Å—ã
- `.farm-leaf` - —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è farm-grown –∏–∫–æ–Ω–æ–∫
- `.breathe` - –∞–Ω–∏–º–∞—Ü–∏—è –¥—ã—Ö–∞–Ω–∏—è –∫—Ä—É–∂–æ—á–∫–æ–≤
- `.menu-container` - —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å—Ç–∏–ª–∏ –º–µ–Ω—é
- `.pacman-*` - —Å—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–∞–∫–º–∞–Ω–∞

### –¶–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞
- **–û—Å–Ω–æ–≤–Ω–æ–π –∑–µ–ª–µ–Ω—ã–π**: `#536C4A` (—Ç–µ–º–Ω–æ-–∑–µ–ª–µ–Ω—ã–π)
- **–°–≤–µ—Ç–ª—ã–π –∑–µ–ª–µ–Ω—ã–π**: `#B0BF93` (—Å–≤–µ—Ç–ª–æ-–∑–µ–ª–µ–Ω—ã–π)
- **Farm-grown**: `#b0bf93` (—Å–≤–µ—Ç–ª–æ-–∑–µ–ª–µ–Ω—ã–π –¥–ª—è farm-grown –∏–∫–æ–Ω–æ–∫)
- **–ì—Ä–∞–¥–∏–µ–Ω—Ç—ã**: `from-[#536C4A] to-[#B0BF93]`

### –¢–∏–ø—ã –∫–∞–Ω–Ω–∞–±–∏—Å–∞ (—Ü–≤–µ—Ç–æ–≤–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ)
- **Hybrid**: `#4f7bff` (—Å–∏–Ω–∏–π)
- **Sativa**: `#ff6633` (–æ—Ä–∞–Ω–∂–µ–≤—ã–π)  
- **Indica**: `#38b24f` (–∑–µ–ª–µ–Ω—ã–π)

### Responsive Design
- **Mobile-first** –ø–æ–¥—Ö–æ–¥
- **Breakpoints**: sm, md, lg (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ Tailwind)
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã**: —Ä–∞–∑–Ω—ã–µ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –∏ –¥–µ—Å–∫—Ç–æ–ø–∞

### –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç Tailwind**: –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ —á–µ—Ä–µ–∑ utility –∫–ª–∞—Å—Å—ã
- **–ö–∞—Å—Ç–æ–º–Ω—ã–π CSS**: —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∞–Ω–∏–º–∞—Ü–∏–π –∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **Inline —Å—Ç–∏–ª–∏**: –∏–∑–±–µ–≥–∞–µ–º, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π (—Ü–≤–µ—Ç–∞ —Ç–∏–ø–æ–≤ –∫–∞–Ω–Ω–∞–±–∏—Å–∞)

## üîß –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
**–§–∞–π–ª—ã**: `src/lib/google.ts`, `src/app/menu/page.tsx`

- **ISR**: `export const revalidate = 900` (15 –º–∏–Ω—É—Ç)
- **Fallback –¥–∞–Ω–Ω—ã–µ**: –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö API –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è mock –¥–∞–Ω–Ω—ã–µ
- **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**: 
  - `GS_CLIENT_EMAIL` - email —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
  - `GS_PRIVATE_KEY` - –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á
  - `GS_SHEET_ID` - ID Google —Ç–∞–±–ª–∏—Ü—ã

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
**–§–∞–π–ª**: `src/components/AutoRefresh.tsx`

- **–ò–Ω—Ç–µ—Ä–≤–∞–ª**: –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å ISR)
- **–§—É–Ω–∫—Ü–∏—è**: —Å–±—Ä–æ—Å –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–∞–∫–º–∞–Ω–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ browser notifications

### 3. –ê–Ω–∏–º–∞—Ü–∏—è "–¥—ã—Ö–∞–Ω–∏—è" –∫—Ä—É–∂–æ—á–∫–æ–≤
**–§–∞–π–ª—ã**: `src/components/BreathingController.tsx`, `src/app/globals.css`

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–Ω–∏–º–∞—Ü–∏–∏:
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≥—Ä—É–ø–ø—ã**: 12 —Å–µ–∫—É–Ω–¥
- **–ü–∞—É–∑–∞ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏**: 6 —Å–µ–∫—É–Ω–¥
- **–§–∏–Ω–∞–ª—å–Ω–∞—è –ø–∞—É–∑–∞**: 15 —Å–µ–∫—É–Ω–¥
- **–ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª**: 63 —Å–µ–∫—É–Ω–¥—ã

#### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
1. Hybrid (—Å–∏–Ω–∏–µ) - 12—Å –¥—ã—Ö–∞–Ω–∏—è + 6—Å –ø–∞—É–∑–∞
2. Sativa (–æ—Ä–∞–Ω–∂–µ–≤—ã–µ) - 12—Å –¥—ã—Ö–∞–Ω–∏—è + 6—Å –ø–∞—É–∑–∞  
3. Indica (–∑–µ–ª–µ–Ω—ã–µ) - 12—Å –¥—ã—Ö–∞–Ω–∏—è + 15—Å –ø–∞—É–∑–∞
4. –ü–æ–≤—Ç–æ—Ä —Ü–∏–∫–ª–∞

#### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:
- **CSS –∞–Ω–∏–º–∞—Ü–∏—è**: `@keyframes breathe` (3—Å –Ω–∞ —Ü–∏–∫–ª)
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–¥–æ—Ö–æ–≤**: 4 –∑–∞ 12 —Å–µ–∫—É–Ω–¥
- **–°–µ–ª–µ–∫—Ç–æ—Ä—ã**: `body.breathing-{type} .dot-{type}`
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: –º–µ–∂–¥—É –ª–µ–≥–µ–Ω–¥–æ–π –∏ –ø—É–Ω–∫—Ç–∞–º–∏ –º–µ–Ω—é

### 4. –ê–Ω–∏–º–∞—Ü–∏—è Pacman
**–§–∞–π–ª**: `src/components/PacmanTrail.tsx`

- **Canvas-based** —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–ª–µ–¥–∞
- **SVG** –¥–ª—è —Å–∞–º–æ–≥–æ –ø–∞–∫–º–∞–Ω–∞
- **–ú–∞—Ä—à—Ä—É—Ç**: –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø—É—Ç—å –ø–æ —ç–∫—Ä–∞–Ω—É
- **–°–ª–µ–¥**: –ø–ª–∞–≤–Ω–æ–µ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ —Å opacity

### 5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Sheets
**–§–∞–π–ª**: `src/lib/google.ts`

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:
```typescript
interface MenuRow {
  Category: string | null;
  Name: string | null;
  THC?: number | null;
  CBG?: number | null;
  Price_1pc?: number | null;
  Price_1g?: number | null;
  Price_5g?: number | null;
  Price_20g?: number | null;
  Type?: string | null;
  Our?: boolean | null;
}
```

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
- **Graceful degradation**: fallback –Ω–∞ mock –¥–∞–Ω–Ω—ã–µ
- **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ API
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª—é—á–µ–π**: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ PEM

## üéØ UI/UX –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (`src/app/page.tsx`)
- **–ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω**: —Ç–µ–º–Ω–æ-–∑–µ–ª–µ–Ω—ã–π –∫ —Å–≤–µ—Ç–ª–æ-–∑–µ–ª–µ–Ω–æ–º—É
- **–°—Ç–µ–∫–ª—è–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç**: `backdrop-blur-lg` –Ω–∞ –±–µ–ª–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- **–†–∞–º–∫–∞**: —É–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è –∑–µ–ª–µ–Ω–∞—è —Ä–∞–º–∫–∞ (3px –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö, 2px –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ)
- **–û—Ç—Å—Ç—É–ø—ã**: —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ —Å–≤–µ—Ä—Ö—É –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –∑–µ–ª–µ–Ω–æ–≥–æ —Ñ–æ–Ω–∞

### –°—Ç—Ä–∞–Ω–∏—Ü–∞ –º–µ–Ω—é (`src/app/menu/page.tsx`)
- **–¢—Ä–µ—Ö–∫–æ–ª–æ–Ω–æ—á–Ω–∞—è —Å–µ—Ç–∫–∞**: –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã
- **–¶–≤–µ—Ç–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã**: –∫—Ä—É–∂–æ—á–∫–∏ –¥–ª—è —Ç–∏–ø–æ–≤ –∫–∞–Ω–Ω–∞–±–∏—Å–∞
- **–õ–µ–≥–µ–Ω–¥–∞**: –≤ footer —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º —Ü–≤–µ—Ç–æ–≤
- **Hover —ç—Ñ—Ñ–µ–∫—Ç—ã**: –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π

### –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –∏–∫–æ–Ω–∫–∏
- **–£–º–µ–Ω—å—à–µ–Ω–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã**: `gap-4` –≤–º–µ—Å—Ç–æ `gap-5` (-20%)
- **Hover –∞–Ω–∏–º–∞—Ü–∏–∏**: `hover:scale-125`
- **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã**: Instagram, Telegram, WhatsApp, Facebook, TripAdvisor

## üöÄ Deployment

### PM2 –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`ecosystem.config.js`)
```javascript
{
  name: 'oglab-site',
  script: 'npm',
  args: 'start',
  instances: 1,
  exec_mode: 'fork',
  env: {
    NODE_ENV: 'production',
    PORT: 3001,
    NODE_OPTIONS: '--no-deprecation'
  },
  autorestart: true
}
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `.env.production` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
GS_CLIENT_EMAIL=your-service-account@project.iam.gserviceaccount.com
GS_SHEET_ID=your-google-sheet-id
GS_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----"
NODE_ENV=production
PORT=3001
```

### –ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
pm2 stop oglab-site

# –ó–∞–ø—É—Å–∫
pm2 start ecosystem.config.js

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
pm2 restart oglab-site

# –õ–æ–≥–∏
pm2 logs oglab-site
```

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### 1. –ö–æ–Ω—Ñ–ª–∏–∫—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
- **PulseController** –∏ **BreathingController** –º–æ–≥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å
- **–†–µ—à–µ–Ω–∏–µ**: –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–∞–∑–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –∏ –∫–ª–∞—Å—Å—ã
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: —á–µ—Ä–µ–∑ console.log –≤ –±—Ä–∞—É–∑–µ—Ä–µ

### 2. Fallback –¥–∞–Ω–Ω—ã–µ
- –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ Google Sheets API –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è mock –¥–∞–Ω–Ω—ã–µ
- **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã**: OG Kush, White Widow –∏ –¥—Ä.
- **–ü—Ä–æ–≤–µ—Ä–∫–∞**: –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞

### 3. ISR –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –º–∞–∫—Å–∏–º—É–º —Ä–∞–∑ –≤ 15 –º–∏–Ω—É—Ç
- **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: —á–µ—Ä–µ–∑ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `npm run dev` –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

### 4. CSS –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
- **–ü—Ä–æ–±–ª–µ–º–∞**: CSS –∫–ª–∞—Å—Å—ã –≤ `globals.css` –º–æ–≥—É—Ç –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å inline —Å—Ç–∏–ª–∏
- **–ü—Ä–∏–º–µ—Ä**: `.farm-leaf { fill: var(--color-primary) }` –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç `fill="#b0bf93"`
- **–†–µ—à–µ–Ω–∏–µ**: –∏–∑–º–µ–Ω—è—Ç—å CSS –∫–ª–∞—Å—Å—ã, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ inline —Å—Ç–∏–ª–∏
- **–ú–µ—Å—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏**:
  - `src/app/globals.css` - –∫–∞—Å—Ç–æ–º–Ω—ã–µ CSS –∫–ª–∞—Å—Å—ã
  - CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `:root`
  - Tailwind –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `tailwind.config.js`

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- **Next.js Image**: –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- **CSS-in-JS**: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π, —Ç–æ–ª—å–∫–æ Tailwind
- **Code splitting**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤ Next.js
- **ISR**: —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **Google Analytics**: –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω (G-SF3PJN87G9)
- **Console logging**: –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∞–Ω–∏–º–∞—Ü–∏–π –∏ API
- **PM2 monitoring**: –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
1. **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞**: –ª–æ–∫–∞–ª—å–Ω–æ —Å `npm run dev`
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
3. **–î–µ–ø–ª–æ–π**: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —á–µ—Ä–µ–∑ PM2
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–µ–Ω—é
1. **Google Sheets**: –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**: —á–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç (ISR)
3. **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ**: –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ PM2 –∏–ª–∏ –æ–∂–∏–¥–∞–Ω–∏–µ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: $(date)*
*–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞: 1.0.0*
*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: –¥–µ–∫–∞–±—Ä—å 2024*
